<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.5.2" />
<title></title>
<style type="text/css">
/* Debug borders */
p, li, dt, dd, div, pre, h1, h2, h3, h4, h5, h6 {
/*
  border: 1px solid red;
*/
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

tt {
  color: navy;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  font-family: sans-serif;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}

div.sectionbody {
  font-family: serif;
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}

pre {
  padding: 0;
  margin: 0;
}

span#author {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  font-size: 1.1em;
}
span#email {
}
span#revnumber, span#revdate, span#revremark {
  font-family: sans-serif;
}

div#footer {
  font-family: sans-serif;
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
div#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
div#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

div#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.tableblock, div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #dddddd;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > div.content {
  white-space: pre;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-family: sans-serif;
  font-weight: bold;
}
tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}


@media print {
  div#footer-badges { display: none; }
}

div#toc {
  margin-bottom: 2.5em;
}

div#toctitle {
  color: #527bbd;
  font-family: sans-serif;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}
/* Workarounds for IE6's broken and incomplete CSS2. */

div.sidebar-content {
  background: #ffffee;
  border: 1px solid silver;
  padding: 0.5em;
}
div.sidebar-title, div.image-title {
  color: #527bbd;
  font-family: sans-serif;
  font-weight: bold;
  margin-top: 0.0em;
  margin-bottom: 0.5em;
}

div.listingblock div.content {
  border: 1px solid silver;
  background: #f4f4f4;
  padding: 0.5em;
}

div.quoteblock-attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock-content {
  white-space: pre;
}
div.verseblock-attribution {
  padding-top: 0.75em;
  text-align: left;
}

div.exampleblock-content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

/* IE6 sets dynamically generated links as visited. */
div#toc a:visited { color: blue; }
</style>
<script type="text/javascript">
/*<![CDATA[*/
window.onload = function(){asciidoc.footnotes();}
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  var cont = document.getElementById("content");
  var noteholder = document.getElementById("footnotes");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      // Use [\s\S] in place of . so multi-line matches work.
      // Because JavaScript has no s (dotall) regex flag.
      note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      spans[i].innerHTML =
        "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
        "' title='View footnote' class='footnote'>" + n + "</a>]";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
}

}
/*]]>*/
</script>
</head>
<body>
<div id="header">
</div>
<div id="content">
<h2 id="_undefined_null">1. undefined 不等于 null</h2>
<div class="sectionbody">
<div class="paragraph"><p><tt>null</tt> 是一个对象，<tt>undefined</tt> 是一个属性、方法或变量。存在null是因为对象被定义。如果对象没有被定义，而测试它是否是null，但因为没有被定义，它无法测试到，而且会抛出错误。</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span>myObject <span style="color: #990000">!==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span>  <span style="color: #990000">&amp;&amp;</span> <span style="font-weight: bold"><span style="color: #0000FF">typeof</span></span><span style="color: #990000">(</span>myObject<span style="color: #990000">)</span> <span style="color: #990000">!==</span> <span style="color: #FF0000">'undefined'</span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>

 <span style="font-style: italic"><span style="color: #9A1900">//如果myObject是undefined，它不能测试是否为null，而且还会抛出错误</span></span>
<span style="color: #FF0000">}</span>

<span style="font-weight: bold"><span style="color: #0000FF">if</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">typeof</span></span><span style="color: #990000">(</span>myObject<span style="color: #990000">)</span> <span style="color: #990000">!==</span> <span style="color: #FF0000">'undefined'</span> <span style="color: #990000">&amp;&amp;</span> myObject <span style="color: #990000">!==</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
 <span style="font-style: italic"><span style="color: #9A1900">//处理myObject的代码</span></span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
</div>
<h2 id="_">2. ==</h2>
<div class="sectionbody">
<div class="paragraph"><p>使浏览器的内存占用量长期达到100%,或者直接崩溃,多半是死循环造成的.并且不止FOR等语句会形成死循环,正则表达式也是造成死循环的可能性之一.</p></div>
</div>
<h2 id="__2">3. ==</h2>
<div class="sectionbody">
<div class="paragraph"><p>document.write 只能用在文档还在解析的过程中,如果文档已经建立,再使用document.write,会刷新出一个新文档流.</p></div>
</div>
<h2 id="__3">4. ==</h2>
<div class="sectionbody">
<div class="paragraph"><p>IE在解析文档的过程中,如果在容器还没有关闭的情况下,向该容器appendchild会出现致命的问题,导致IE无法继续解析文档,直接显示无法打开网页.改用document.write()即可.</p></div>
</div>
<h2 id="_jquery">5. jquery的不当使用导致内存泄漏</h2>
<div class="sectionbody">
<div class="paragraph"><p>首先，jquery有内部的防泄漏机制，它在unload里面卸载了所有绑定和引用，导致内存得以释放，但是如果将jquery对象存入了自定义的变量中后，会使内存泄漏成为一个问题。</p></div>
<div class="paragraph"><p>过去看过一篇关于优化jquery性能的翻译文章，其中第三条便是“将jquery对象缓存起来”，也就是将jquery取得的DOM对象存入自定义的变量之中，以后要用到同一元素时就避免了再让jquery的查询引擎重新去DOM中搜索，大大节省的资源和时间从而极大的提高了性能，也就是一种缓冲机制。这种缓存技巧是值得提倡的，但决不能乱用，否则百分之百的会造成内存泄漏，不管是弱智的ie还是强大的firefox，都无法逃避。</p></div>
<h3 id="__4">5.1. 选择器使用不当</h3><div style="clear:left"></div>
<div class="paragraph"><p>如下的子查询也是那篇优化jquery性能中提倡的：</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$tabs <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">'#main'</span><span style="color: #990000">);</span>  
$tabs<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">find</span></span><span style="color: #990000">(</span><span style="color: #FF0000">".ui-tabs-nav"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">sortable</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{</span>axis<span style="color: #990000">:</span><span style="color: #FF0000">'y'</span><span style="color: #FF0000">}</span><span style="color: #990000">);</span>
$tabs <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>

<span style="font-style: italic"><span style="color: #9A1900">// $tabs包含的DOM元素会泄漏出去。</span></span>

<span style="font-style: italic"><span style="color: #9A1900">// 还有种选择器也会造成同样情况：</span></span>

$tabs <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">'#main'</span><span style="color: #990000">);</span> 
$li      <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">'li'</span><span style="color: #990000">,</span>$tabs<span style="color: #990000">);</span>
$tabs <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>

<span style="font-style: italic"><span style="color: #9A1900">// 这种选择同样也会造成内存泄漏，原因不详。</span></span>
</tt></pre></div></div>
<h3 id="__5">5.2. 事件绑定时自身循环引用</h3><div style="clear:left"></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> $tab_items <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">"#main ul:first li"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">droppable</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{</span>
    tolerance<span style="color: #990000">:</span> <span style="color: #FF0000">'pointer'</span><span style="color: #990000">,</span>
    accept<span style="color: #990000">:</span> <span style="color: #FF0000">".connectedSortable li"</span><span style="color: #990000">,</span>
    hoverClass<span style="color: #990000">:</span> <span style="color: #FF0000">"ui-state-hover"</span><span style="color: #990000">,</span>
    drop<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>ev<span style="color: #990000">,</span> ui<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> $item <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
        <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> $list <span style="color: #990000">=</span> $<span style="color: #990000">(</span>$item<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">find</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'a'</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">attr</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'href'</span><span style="color: #990000">)).</span><span style="font-weight: bold"><span style="color: #000000">find</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'.connectedSortable'</span><span style="color: #990000">);</span>

        ui<span style="color: #990000">.</span>draggable<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hide</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'slow'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
            <span style="font-style: italic"><span style="color: #9A1900">// auto change tab on/off</span></span>
            $tabs<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">tabs</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'select'</span><span style="color: #990000">,</span> $tab_items<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">index</span></span><span style="color: #990000">(</span>$item<span style="color: #990000">));</span>
            $<span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">prependTo</span></span><span style="color: #990000">(</span>$list<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'slow'</span><span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span><span style="color: #990000">);</span><span style="font-style: italic"><span style="color: #9A1900">//end hide</span></span>
        $item <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
        $list <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
  <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
  $tab_items <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
  $tabs <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>在对$tab_item元素进行绑定的回调函数里，又引用了该元素本身，因此会导致内存泄漏，即时后面将其显示设为null,也不能避免该问题。</p></div>
<div class="paragraph"><p>元素之间的循环引用</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt> <span style="font-style: italic"><span style="color: #9A1900">// tabs &amp;&amp; drop to tabs</span></span>
  $tabs <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">"#main"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">tabs</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{</span>
    <span style="font-style: italic"><span style="color: #9A1900">//selected: 0,</span></span>
    panelsTarget <span style="color: #990000">:</span> <span style="color: #FF0000">'#js_panelsTarget'</span><span style="color: #990000">,</span>
    spinner<span style="color: #990000">:</span> <span style="color: #FF0000">'Retrieving data...'</span><span style="color: #990000">,</span>
    cache<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">true</span></span><span style="color: #990000">,</span>
    cookie<span style="color: #990000">:</span> <span style="color: #FF0000">{</span>expires<span style="color: #990000">:</span> <span style="color: #993399">30</span><span style="color: #990000">,</span>name<span style="color: #990000">:</span><span style="color: #FF0000">'ui-tab'</span><span style="color: #FF0000">}</span><span style="color: #990000">,</span>
    select<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>event<span style="color: #990000">,</span> ui<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="color: #FF0000">}</span>
  <span style="color: #FF0000">}</span><span style="color: #990000">);</span>

  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> $tab_items <span style="color: #990000">=</span> $<span style="color: #990000">(</span><span style="color: #FF0000">"#main ul:first li"</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">droppable</span></span><span style="color: #990000">(</span><span style="color: #FF0000">{</span>
    tolerance<span style="color: #990000">:</span> <span style="color: #FF0000">'pointer'</span><span style="color: #990000">,</span>
    accept<span style="color: #990000">:</span> <span style="color: #FF0000">".connectedSortable li"</span><span style="color: #990000">,</span>
    hoverClass<span style="color: #990000">:</span> <span style="color: #FF0000">"ui-state-hover"</span><span style="color: #990000">,</span>
    drop<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>ev<span style="color: #990000">,</span> ui<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        ui<span style="color: #990000">.</span>draggable<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">hide</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'slow'</span><span style="color: #990000">,</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
            <span style="font-style: italic"><span style="color: #9A1900">// auto change tab on/off</span></span>
            $tabs<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">tabs</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'select'</span><span style="color: #990000">,</span> $<span style="color: #990000">(</span><span style="color: #FF0000">'#main ul:first li'</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">index</span></span><span style="color: #990000">(</span>$item<span style="color: #990000">));</span>
            $<span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">prependTo</span></span><span style="color: #990000">(</span>$list<span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">show</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'slow'</span><span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span><span style="color: #990000">);</span><span style="font-style: italic"><span style="color: #9A1900">//end hide</span></span>
        $item <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
        $list <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
    <span style="color: #FF0000">}</span>
  <span style="color: #FF0000">}</span><span style="color: #990000">);</span>
  $tab_items <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span></tt></pre></div></div>
<div class="paragraph"><p>这个和在自身回调函数中引用自己是一个道理。</p></div>
</div>
<h2 id="_tt_tt">6. <tt>!!</tt> 的使用</h2>
<div class="sectionbody">
<div class="paragraph"><p>javascript中两个感叹号用于判断变量是否为null,undefined,'',0。
注意：该变量必须声明过，否则报错。</p></div>
<div class="paragraph"><p>测试代码如下：</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">var</span></span> a <span style="color: #990000">=</span> <span style="color: #993399">123</span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>a<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output true</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//未申明变量</span></span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output ReferenceError: b is not defined</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">var</span></span> b<span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output false</span></span>
b <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">null</span></span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output false</span></span>
b<span style="color: #990000">=</span><span style="color: #FF0000">''</span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output false</span></span>
b<span style="color: #990000">=</span><span style="color: #993399">0</span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output false</span></span>
b<span style="color: #990000">=</span><span style="color: #993399">1</span><span style="color: #990000">;</span>
<span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(!!</span>b<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">//output true</span></span></tt></pre></div></div>
</div>
<h2 id="_javascript_factory">7. Javascript设计模式--工厂模式(factory)</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">定义一个父类</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * class Command</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Command的超类</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> params</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">Command</span></span><span style="color: #990000">(</span>params<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>params <span style="color: #990000">=</span> params <span style="color: #990000">||</span> <span style="color: #FF0000">{}</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
Command<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>setParams <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>params<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>params <span style="color: #990000">=</span> params<span style="color: #990000">;</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="listingblock">
<div class="title">定义一系统子类</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * class AddNoteCommand extends Command</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> params</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">AddNoteCommand</span></span><span style="color: #990000">(</span>params<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  Command<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>name <span style="color: #990000">=</span> <span style="color: #FF0000">'addNote'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
AddNoteCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Command</span></span><span style="color: #990000">();</span>


AddNoteCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>success <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
    <span style="font-style: italic"><span style="color: #9A1900">//some code</span></span>
<span style="color: #FF0000">}</span>


<span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * class CreateCategoryCommand extends Command</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> params</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">CreateCategoryCommand</span></span><span style="color: #990000">(</span>params<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  Command<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>name <span style="color: #990000">=</span> <span style="color: #FF0000">'CreateCategory'</span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
CreateCategoryCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Command</span></span><span style="color: #990000">();</span>


CreateCategoryCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>success <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
    <span style="font-style: italic"><span style="color: #9A1900">//some code</span></span>
<span style="color: #FF0000">}</span>
CreateCategoryCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>beforeSubmit <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
   <span style="font-style: italic"><span style="color: #9A1900">//some code</span></span>
<span style="color: #FF0000">}</span>
CreateCategoryCommand<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>getExtraData <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
  <span style="font-style: italic"><span style="color: #9A1900">//some code</span></span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="listingblock">
<div class="title">定义工厂类</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * Class CommandFactory</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@param</span><span style="font-style: italic"><span style="color: #9A1900"> commandType</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">CommandFactory</span></span><span style="color: #990000">(</span>commandType<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> command <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">ucwords</span></span><span style="color: #990000">(</span>commandType<span style="color: #990000">);</span>  <span style="font-style: italic"><span style="color: #9A1900">//ucwords为自定义函数</span></span>
  command <span style="color: #990000">+=</span> <span style="color: #FF0000">'Command'</span><span style="color: #990000">;</span>
  <span style="font-style: italic"><span style="color: #9A1900">//console.log(command);</span></span>
  <span style="font-style: italic"><span style="color: #9A1900">//确认所请求的Command类是存在的</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'typeof '</span> <span style="color: #990000">+</span> command <span style="color: #990000">+</span> <span style="color: #FF0000">' != "undefined"'</span><span style="color: #990000">))</span> <span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #000000">eval</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'new '</span> <span style="color: #990000">+</span> command <span style="color: #990000">+</span> <span style="color: #FF0000">'()'</span><span style="color: #990000">);</span>
  <span style="color: #FF0000">}</span> <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
        <span style="font-style: italic"><span style="color: #9A1900">//如果不存在,则返回一个超类做替代,超类不调用任何回调函数</span></span>
        <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Command</span></span><span style="color: #990000">();</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="listingblock">
<div class="title">实例化</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> command_1 <span style="color: #990000">=</span> ‘addNote<span style="color: #FF0000">';</span>
<span style="color: #FF0000">  var command_2 = '</span>createCategory<span style="color: #FF0000">';</span>
<span style="color: #FF0000">  var c1 = new CommandFactory(‘addNote'</span><span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">//返回AddNoteCommand的实例</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> c2 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">CommandFactory</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'createCategory'</span><span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">//返回CreateCategory的实例</span></span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> c3 <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">CommandFactory</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'unexistedCommand'</span><span style="color: #990000">);</span> <span style="font-style: italic"><span style="color: #9A1900">//返回Command的实例</span></span></tt></pre></div></div>
</div>
<h2 id="_addloadevent">8. addLoadEvent</h2>
<div class="sectionbody">
<div class="paragraph"><p>在没有jQuery情况下兼容IE,FF的window.onload事件绑定函数</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">addLoadEvent</span></span><span style="color: #990000">(</span>func<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> oldonload <span style="color: #990000">=</span> window<span style="color: #990000">.</span>onload<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">typeof</span></span> window<span style="color: #990000">.</span>onload <span style="color: #990000">!=</span> <span style="color: #FF0000">'function'</span> <span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        window<span style="color: #990000">.</span>onload <span style="color: #990000">=</span> func<span style="color: #990000">;</span>
    <span style="font-weight: bold"><span style="color: #0000FF">else</span></span> <span style="color: #FF0000">{</span>
        window<span style="color: #990000">.</span>onload <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span><span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #000000">oldonload</span></span><span style="color: #990000">();</span>
            <span style="font-weight: bold"><span style="color: #000000">func</span></span><span style="color: #990000">();</span>
        <span style="color: #FF0000">}</span>
    <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
</div>
<h2 id="_javascript_array_object">9. javascript中array和object的关系</h2>
<div class="sectionbody">
<div class="paragraph"><p>Javascript中存在一个叫做伪数组的的东西, 它介于Object和Array之间, 最重要的使用就是函数的参数数组 arguments , 这里我们来讨论下 Array 和 Object 之间到底是个怎样的关系,  为什么可以出现类似伪数组的灰色地带出现.</p></div>
<div class="paragraph"><p>如所有对象一样，Array也继承于Object，因此Array和Object的内部结构其实差不多，也可以利用Array的内置方法来操作Object对象，使其具有伪数组的功能；
代码示范：</p></div>
<div class="listingblock">
<div class="title">首先来看看Array的内部结构</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-style: italic"><span style="color: #9A1900">//确定Array继承于Object</span></span>
Array <span style="font-weight: bold"><span style="color: #0000FF">instanceof</span></span> Object
<span style="font-style: italic"><span style="color: #9A1900">// true</span></span>

<span style="font-weight: bold"><span style="color: #0000FF">var</span></span> arr <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">,</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">2</span><span style="color: #990000">];</span>
<span style="font-style: italic"><span style="color: #9A1900">// 相当于以数字索引为key，以数组各值为value,然后带一个length属性的Object对象</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">var</span></span> obj <span style="color: #990000">=</span> <span style="color: #FF0000">{</span><span style="color: #993399">0</span><span style="color: #990000">:</span><span style="color: #993399">0</span><span style="color: #990000">,</span> <span style="color: #993399">1</span><span style="color: #990000">:</span><span style="color: #993399">1</span><span style="color: #990000">,</span> <span style="color: #993399">2</span><span style="color: #990000">:</span><span style="color: #993399">2</span><span style="color: #990000">,</span> length<span style="color: #990000">:</span><span style="color: #993399">3</span><span style="color: #FF0000">}</span>；</tt></pre></div></div>
<div class="listingblock">
<div class="title">用Array内置方法操作Object对象：</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="color: #990000">//</span> 使用Array的push方法操作Object对象

var obj <span style="color: #990000">=</span> {}<span style="color: #990000">;</span>
Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>push<span style="color: #990000">.</span>call<span style="color: #990000">(</span>obj<span style="color: #990000">,</span><span style="color: #993399">123</span><span style="color: #990000">);</span>
<span style="color: #990000">//</span> <span style="color: #993399">1</span>

<span style="color: #990000">//</span> push后，Object对象自动添加length属性，并以数字索引做key
console<span style="color: #990000">.</span>log<span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="color: #990000">//</span> Object <span style="color: #993399">0</span><span style="color: #990000">=</span><span style="color: #993399">123</span> <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">1</span>

<span style="color: #990000">//</span> 使用Array的slice方法操作Object对象
Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>slice<span style="color: #990000">.</span>call<span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="color: #990000">//</span> <span style="color: #990000">[</span><span style="color: #993399">123</span><span style="color: #990000">]</span>

<span style="color: #990000">//</span>手工添加数字索引的属性，将不会被pop/slice等函数读取到。
obj<span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">]</span> <span style="color: #990000">=</span> <span style="color: #993399">312</span><span style="color: #990000">;</span>
<span style="color: #990000">//</span> <span style="color: #993399">312</span>
console<span style="color: #990000">.</span>log<span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="color: #990000">//</span> Object <span style="color: #993399">0</span><span style="color: #990000">=</span><span style="color: #993399">123</span> <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">1</span> <span style="color: #993399">1</span><span style="color: #990000">=</span><span style="color: #993399">312</span>

<span style="color: #990000">//</span>使用slice或pop去读取该伪数组
<span style="color: #990000">//</span>只会读出push方法写入的属性
Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>slice<span style="color: #990000">.</span>call<span style="color: #990000">(</span>obj，<span style="color: #993399">0</span><span style="color: #990000">);</span>
<span style="color: #990000">//</span> <span style="color: #990000">[</span><span style="color: #993399">123</span><span style="color: #990000">]</span>
Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>pop<span style="color: #990000">.</span>call<span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="color: #990000">//</span> <span style="color: #993399">123</span>
console<span style="color: #990000">.</span>log<span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="color: #990000">//</span> Object <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">0</span> <span style="color: #993399">1</span><span style="color: #990000">=</span><span style="color: #993399">312</span></tt></pre></div></div>
<div class="listingblock">
<div class="title">也可以直接让Object拥有Array方法：</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="color: #990000">//</span> firebug控制台

<span style="color: #990000">&gt;&gt;&gt;</span> Object<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>pop   <span style="color: #990000">=</span> Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>pop<span style="color: #990000">;</span>
<span style="color: #990000">&gt;&gt;&gt;</span> Object<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>slice <span style="color: #990000">=</span> Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>slice<span style="color: #990000">;</span>
<span style="color: #990000">&gt;&gt;&gt;</span> Object<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>push  <span style="color: #990000">=</span> Array<span style="color: #990000">.</span>prototype<span style="color: #990000">.</span>push<span style="color: #990000">;</span>

<span style="color: #990000">&gt;&gt;&gt;</span> var obj <span style="color: #990000">=</span> {}<span style="color: #990000">;</span>
<span style="color: #990000">&gt;&gt;&gt;</span> obj<span style="color: #990000">.</span>push<span style="color: #990000">(</span><span style="color: #993399">123</span><span style="color: #990000">);</span>
<span style="color: #990000">&gt;&gt;&gt;</span> obj<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">pop()</span></span><span style="color: #990000">;</span>
<span style="color: #993399">123</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj
Object <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">0</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj<span style="color: #990000">.</span>push<span style="color: #990000">(</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">2</span><span style="color: #990000">,</span><span style="color: #993399">3</span><span style="color: #990000">);</span>
<span style="color: #993399">3</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">slice()</span></span><span style="color: #990000">;</span>
<span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">,</span> <span style="color: #993399">2</span><span style="color: #990000">,</span> <span style="color: #993399">3</span><span style="color: #990000">]</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj
Object <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">3</span> <span style="color: #993399">0</span><span style="color: #990000">=</span><span style="color: #993399">1</span> <span style="color: #993399">1</span><span style="color: #990000">=</span><span style="color: #993399">2</span> <span style="color: #993399">2</span><span style="color: #990000">=</span><span style="color: #993399">3</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj
Object <span style="color: #009900">length</span><span style="color: #990000">=</span><span style="color: #993399">3</span> <span style="color: #993399">0</span><span style="color: #990000">=</span><span style="color: #993399">1</span> <span style="color: #993399">1</span><span style="color: #990000">=</span><span style="color: #993399">2</span> <span style="color: #993399">2</span><span style="color: #990000">=</span><span style="color: #993399">3</span>

<span style="color: #990000">&gt;&gt;&gt;</span> obj<span style="color: #990000">[</span><span style="color: #993399">0</span><span style="color: #990000">];</span>
<span style="color: #993399">1</span>
</tt></pre></div></div>
<div class="listingblock">
<div class="title">将普通对象转为为 arguments 的伪数组</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-weight: bold"><span style="color: #0000FF">var</span></span> obj <span style="color: #990000">=</span> <span style="color: #FF0000">{}</span><span style="color: #990000">;</span>
Array<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>push<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">,</span> <span style="color: #FF0000">'arg1'</span><span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">// 注意,这里push的调用主体是obj,所有push将会直接对原数组(这里是obj对象)直接进行操作,返回值也和push方法的返回值是一样的, 返回的是一个数值, 而非返回该数组本身.</span></span>

args <span style="color: #990000">=</span> Array<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>slice<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span>obj<span style="color: #990000">);</span>
<span style="font-style: italic"><span style="color: #9A1900">// 这里的slice方法也是Array.slice方法一样, 不会对原数组进行操作, 而是返回一个新数组.</span></span>

<span style="font-style: italic"><span style="color: #9A1900">// 此时args 已经是个伪数组, 和arguments一样使用</span></span>
SomeFunc<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">apply</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> args<span style="color: #990000">);</span>
</tt></pre></div></div>
</div>
<h2 id="_javascript_observer">10. javascript 设计模式 - 观察者模式(Observer)</h2>
<div class="sectionbody">
<div class="paragraph"><p>这里主要介绍一些观察者模式在Javascript中的实现方法:</p></div>
<div class="listingblock">
<div class="title">Observer接口</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-style: italic"><span style="color: #9A1900">/*-------------- IObserver.interface.js ----------------*/</span></span>
<span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * interface IObserver</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">IObserver</span></span><span style="color: #990000">()</span><span style="color: #FF0000">{}</span>
IObserver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>update <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>sender<span style="color: #990000">,</span>msg<span style="color: #990000">)</span><span style="color: #FF0000">{}</span> </tt></pre></div></div>
<div class="listingblock">
<div class="title">Subject接口</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-style: italic"><span style="color: #9A1900">/*-------------- ISubject.interface.js ----------------*/</span></span>

<span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * interface ISubject</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">ISubject</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>_ObserverList <span style="color: #990000">=</span> <span style="color: #990000">[];</span>
<span style="color: #FF0000">}</span>
ISubject<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>addObserver <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>observer<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>_ObserverList<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">push</span></span><span style="color: #990000">(</span>observer<span style="color: #990000">);</span>
  <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
<span style="color: #FF0000">}</span>
ISubject<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>delObserver <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>observer<span style="color: #990000">)</span><span style="color: #FF0000">{}</span> 
ISubject<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>notify <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">(</span>observer<span style="color: #990000">,</span>msg<span style="color: #990000">)</span>
<span style="color: #FF0000">{</span>
  <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> msg <span style="color: #990000">=</span> msg <span style="color: #990000">||</span> <span style="color: #FF0000">{}</span><span style="color: #990000">;</span>
  <span style="font-weight: bold"><span style="color: #0000FF">for</span></span> <span style="color: #990000">(</span>i <span style="font-weight: bold"><span style="color: #0000FF">in</span></span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>_ObserverList<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
<span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>_ObserverList<span style="color: #990000">[</span>i<span style="color: #990000">].</span><span style="font-weight: bold"><span style="color: #000000">update</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span>msg<span style="color: #990000">);</span>
  <span style="color: #FF0000">}</span>
  <span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span>window<span style="color: #990000">.</span>console <span style="color: #990000">&amp;&amp;</span> window<span style="color: #990000">.</span>console<span style="color: #990000">.</span>log<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">log</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'notify at '</span> <span style="color: #990000">+</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">Date</span></span><span style="color: #990000">());</span>
  <span style="color: #FF0000">}</span>
<span style="color: #FF0000">}</span> </tt></pre></div></div>
<div class="listingblock">
<div class="title">Subject实现类</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * class BindCenter implements ISubject</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">BindCenter</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
  ISubject<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span> 
BindCenter<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span> <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">ISubject</span></span><span style="color: #990000">();</span> </tt></pre></div></div>
<div class="listingblock">
<div class="title">Observer实现类</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-style: italic"><span style="color: #9A1900">/** </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * class BindAjaxForm implements IObserver</span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> * </span></span><span style="color: #009900">@return</span><span style="font-style: italic"><span style="color: #9A1900"> </span></span>
<span style="font-style: italic"><span style="color: #9A1900"> */</span></span>
<span style="font-weight: bold"><span style="color: #0000FF">function</span></span> <span style="font-weight: bold"><span style="color: #000000">BindAjaxForm</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span> 
  IObserver<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span>
BindAjaxForm<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>update <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span>
<span style="color: #FF0000">{</span>
    <span style="font-style: italic"><span style="color: #9A1900">//some code</span></span>
    <span style="font-weight: bold"><span style="color: #000000">alert</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'yes,i do'</span><span style="color: #990000">);</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
<div class="listingblock">
<div class="title">使用方法</div>
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
<span style="font-style: italic"><span style="color: #9A1900">/*------------------------ main.js ----------------------*/</span></span>
    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> bindCenter <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> <span style="font-weight: bold"><span style="color: #000000">BindCenter</span></span><span style="color: #990000">();</span>

    <span style="font-style: italic"><span style="color: #9A1900">// 注册观察者</span></span>
    bindCenter<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> BindHighLight<span style="color: #990000">)</span>
              <span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> BindAjaxForm<span style="color: #990000">)</span>
              <span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> BindDelButton<span style="color: #990000">)</span>
              <span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> BindNotes<span style="color: #990000">)</span>
              <span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">addObserver</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">new</span></span> BindLoginForm<span style="color: #990000">);</span>

    <span style="font-style: italic"><span style="color: #9A1900">// 通知所有观察者</span></span>
    bindCenter<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">notify</span></span><span style="color: #990000">();</span></tt></pre></div></div>
</div>
<h2 id="_jquery_2">11. jQuery源代码研究--伪数组</h2>
<div class="sectionbody">
<div class="paragraph"><p>在读jQuery源代码的过程中，发现一个不解的一小段代码：
    </p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>toArray<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
    <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> slice<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span> <span style="color: #993399">0</span> <span style="color: #990000">);</span>
<span style="color: #FF0000">}</span><span style="color: #990000">,</span>
<span style="font-style: italic"><span style="color: #9A1900">//其中slice = Array.prototype.slice;</span></span></tt></pre></div></div>
<div class="paragraph"><p>从平时使用可得知，jQuery对象是一个Object，而非Array。例如：</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>$<span style="color: #990000">(</span><span style="color: #FF0000">'div'</span><span style="color: #990000">)</span> 
<span style="font-style: italic"><span style="color: #9A1900">//实质为：</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//Object</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//0: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//1: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//2: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//3: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//4: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//5: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//context: HTMLDocument</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//length: 6</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//selector: "div"</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//__proto__: Object</span></span>

$<span style="color: #990000">(</span><span style="color: #FF0000">'div'</span><span style="color: #990000">).</span><span style="font-weight: bold"><span style="color: #000000">toArray</span></span><span style="color: #990000">();</span>
<span style="font-style: italic"><span style="color: #9A1900">//得到的则是：</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//Array</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//0: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//1: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//2: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//3: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//4: HTMLDivElement</span></span>
<span style="font-style: italic"><span style="color: #9A1900">//5: HTMLDivElement</span></span></tt></pre></div></div>
<div class="paragraph"><p>jQuery对象在转换成Array时只留下了DOM对象，神奇的去掉了其他属性。由此看出，jQuery具有一种伪数组的特性。</p></div>
<div class="paragraph"><p>将jQuery相关的源代码简化如下：</p></div>
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt>
      <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> arr <span style="color: #990000">=</span> <span style="color: #990000">[</span><span style="color: #993399">1</span><span style="color: #990000">,</span><span style="color: #993399">2</span><span style="color: #990000">];</span>
      <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> jq <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span><span style="color: #FF0000">{</span>
        <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">new</span></span> jq<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">init</span></span><span style="color: #990000">(</span>arguments<span style="color: #990000">);</span>
      <span style="color: #FF0000">}</span>
      jq<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span> <span style="color: #990000">=</span> <span style="color: #FF0000">{</span>
        init<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
            <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">.</span>length <span style="color: #990000">=</span> <span style="color: #993399">0</span><span style="color: #990000">;</span>
            <span style="font-style: italic"><span style="color: #9A1900">//在此便是神奇之处，原来还可以这么用：</span></span>
            <span style="font-style: italic"><span style="color: #9A1900">//使用Array原型中的push，将数组填充到对象中</span></span>
            Array<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>push<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">apply</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span>arr<span style="color: #990000">);</span>
            <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> <span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">;</span>
        <span style="color: #FF0000">}</span><span style="color: #990000">,</span>
        toArray<span style="color: #990000">:</span> <span style="font-weight: bold"><span style="color: #0000FF">function</span></span><span style="color: #990000">()</span> <span style="color: #FF0000">{</span>
            <span style="font-style: italic"><span style="color: #9A1900">//使用Array原型中的slice，将数组读出来</span></span>
            <span style="font-style: italic"><span style="color: #9A1900">//注意：这里只会读取Array.prototype.push到对象中的元素</span></span>
            <span style="font-style: italic"><span style="color: #9A1900">//而对象其他的属性是不会读取的(如本例中的this.length)</span></span>
            <span style="font-weight: bold"><span style="color: #0000FF">return</span></span> Array<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>slice<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">call</span></span><span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">this</span></span><span style="color: #990000">,</span><span style="color: #993399">0</span><span style="color: #990000">);</span>
        <span style="color: #FF0000">}</span>
      <span style="color: #FF0000">}</span>

      <span style="font-style: italic"><span style="color: #9A1900">//为了让inti实例化后对象也具有toArray方法，将原型又指回了jq的原型</span></span>
      jq<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">.</span>init<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span> <span style="color: #990000">=</span> jq<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #0000FF">prototype</span></span><span style="color: #990000">;</span>


    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> o <span style="color: #990000">=</span> <span style="font-weight: bold"><span style="color: #000000">jq</span></span><span style="color: #990000">();</span>
    <span style="font-style: italic"><span style="color: #9A1900">//Object</span></span>
    <span style="font-style: italic"><span style="color: #9A1900">//0: 1</span></span>
    <span style="font-style: italic"><span style="color: #9A1900">//1: 2</span></span>
    <span style="font-style: italic"><span style="color: #9A1900">//length: 2</span></span>
    <span style="font-style: italic"><span style="color: #9A1900">//__proto__: Object </span></span>

    <span style="font-weight: bold"><span style="color: #0000FF">var</span></span> a <span style="color: #990000">=</span> o<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">toArray</span></span><span style="color: #990000">();</span>
    <span style="font-style: italic"><span style="color: #9A1900">// [1,2] </span></span>
    <span style="font-style: italic"><span style="color: #9A1900">//length属性濡</span></span></tt></pre></div></div>
</div>
<h2 id="_filter">12. filter()</h2>
<div class="sectionbody">
<div class="paragraph"><p><tt>array.filter(fileterFunc,this);</tt></p></div>
<div class="paragraph"><p>第二参数设置为 <tt>this</tt> ,可将当前 <tt>this</tt> 传递进 <tt>fileterFunc</tt> 中(即将 <tt>filterFunc</tt> 中的 <tt>this</tt> 设置为当前环境下的 <tt>this</tt> .</p></div>
</div>
<h2 id="_undefined_null_2">13. 确保一个变量不为'undefined','',null</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content"><!-- Generator: GNU source-highlight 3.1.4
by Lorenzo Bettini
http://www.lorenzobettini.it
http://www.gnu.org/software/src-highlite -->
<pre><tt><span style="font-weight: bold"><span style="color: #0000FF">if</span></span> <span style="color: #990000">(</span><span style="font-weight: bold"><span style="color: #0000FF">typeof</span></span> b <span style="color: #990000">!=</span> <span style="color: #FF0000">'undefined'</span> <span style="color: #990000">&amp;&amp;</span> <span style="color: #990000">!!</span>b<span style="color: #990000">)</span> <span style="color: #FF0000">{</span>
        console<span style="color: #990000">.</span><span style="font-weight: bold"><span style="color: #000000">log</span></span><span style="color: #990000">(</span><span style="color: #FF0000">'b 存在,并且不为空'</span><span style="color: #990000">)</span>
<span style="color: #FF0000">}</span></tt></pre></div></div>
</div>
<h2 id="_jquery_css">14. jQuery的CSS类选择器在不同浏览器下性能</h2>
<div class="sectionbody">
<div class="paragraph"><p>在浏览器支持 <tt>querySelectorAll</tt> 的情况下, jQuery是直接使用这个原生方法来支持类CSS选择器的(性能高), 对于不支持的浏览器(例如 IE6,7), 则使用独立的 <tt>Sizzle.js</tt> 来实现相同功能(性能中).</p></div>
</div>
<h2 id="_jquery_name_xxx">15. jQuery中[name=xxx]选择器的性能</h2>
<div class="sectionbody">
<div class="paragraph"><p>例如选择 <tt>&lt;div name="xxx'&gt;&lt;/div&gt;</tt> 时.
<tt>$('[name=xxx]')和 `$('div[name=xxx'])</tt> 在性能上是一样的.</p></div>
<div class="paragraph"><p><tt>$('[name=xxx'])</tt> 在 <tt>Sizzle.js</tt> 模式中, 其实就是直接在调用 <tt>document.getElementsByName('xxx')</tt> , 只是它可以避免在IE6下 <tt>id</tt> 和 <tt>name</tt> 不分的BUG.</p></div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2011-04-05 22:58:05 CST
</div>
</div>
</body>
</html>
